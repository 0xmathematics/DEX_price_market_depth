#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
Created on Fri Jan 24 19:40:03 2025

@author: hang.miaosmartcontract.com
"""

import os
from web3 import Web3
import numpy as np
import pandas as pd
import json
import datetime
import time
import tqdm
from math import sqrt, pi

os.chdir('/Users/hang.miaosmartcontract.com/Documents/GitHub/quantitative_analysis/web3')
infura_url = "https://mainnet.infura.io/v3/52757b6af51f4a50a7645433e21e0d90" # eth

web3 = Web3(Web3.HTTPProvider(infura_url))
print( web3.is_connected() )
web3.eth.get_block_number() 

#%%




def token_info(pool_address):

    
    abi_1 = json.loads('[{"inputs":[{"internalType":"uint256","name":"targetSqrtPrice","type":"uint256"},{"internalType":"uint256","name":"sqrtLowerTickPrice","type":"uint256"},{"internalType":"uint256","name":"sqrtUpperTickPrice","type":"uint256"}],"name":"LensTargetPriceOutOfBounds","type":"error"},{"inputs":[{"internalType":"bool","name":"targetIsA","type":"bool"},{"internalType":"uint256","name":"deltaA","type":"uint256"},{"internalType":"uint256","name":"deltaB","type":"uint256"}],"name":"LensTargetingTokenWithNoDelta","type":"error"},{"inputs":[{"internalType":"uint256","name":"relativeLiquidityAmount","type":"uint256"},{"internalType":"uint256","name":"deltaA","type":"uint256"},{"internalType":"uint256","name":"deltaB","type":"uint256"}],"name":"LensTooLittleLiquidity","type":"error"},{"inputs":[],"name":"LiquidityUtilitiesFailedToFindDeltaAmounts","type":"error"},{"inputs":[{"internalType":"uint256","name":"initialTargetB","type":"uint256"},{"internalType":"uint256","name":"deltaLpBalance","type":"uint256"},{"internalType":"uint256","name":"minimumRequiredLpBalance","type":"uint256"}],"name":"LiquidityUtilitiesInitialTargetBTooSmall","type":"error"},{"inputs":[],"name":"LiquidityUtilitiesNoSwapLiquidity","type":"error"},{"inputs":[{"internalType":"uint256","name":"targetSqrtPrice","type":"uint256"},{"internalType":"uint256","name":"sqrtLowerTickPrice","type":"uint256"},{"internalType":"uint256","name":"sqrtUpperTickPrice","type":"uint256"}],"name":"LiquidityUtilitiesTargetPriceOutOfBounds","type":"error"},{"inputs":[],"name":"MathOverflowedMulDiv","type":"error"},{"inputs":[{"internalType":"uint8","name":"bits","type":"uint8"},{"internalType":"uint256","name":"value","type":"uint256"}],"name":"SafeCastOverflowedUintDowncast","type":"error"},{"inputs":[{"internalType":"int256","name":"tick","type":"int256"}],"name":"TickMaxExceeded","type":"error"},{"inputs":[{"components":[{"internalType":"contract IMaverickV2Pool","name":"pool","type":"address"},{"internalType":"uint8","name":"kind","type":"uint8"},{"internalType":"int32[]","name":"ticks","type":"int32[]"},{"internalType":"uint128[]","name":"relativeLiquidityAmounts","type":"uint128[]"},{"components":[{"internalType":"uint256","name":"slippageFactorD18","type":"uint256"},{"internalType":"uint256","name":"numberOfPriceBreaksPerSide","type":"uint256"},{"internalType":"uint256","name":"targetAmount","type":"uint256"},{"internalType":"bool","name":"targetIsA","type":"bool"}],"internalType":"struct IMaverickV2PoolLens.AddParamsSpecification","name":"addSpec","type":"tuple"}],"internalType":"struct IMaverickV2PoolLens.AddParamsViewInputs","name":"params","type":"tuple"}],"name":"getAddLiquidityParams","outputs":[{"internalType":"bytes","name":"packedSqrtPriceBreaks","type":"bytes"},{"internalType":"bytes[]","name":"packedArgs","type":"bytes[]"},{"internalType":"uint88[]","name":"sqrtPriceBreaks","type":"uint88[]"},{"components":[{"internalType":"uint8","name":"kind","type":"uint8"},{"internalType":"int32[]","name":"ticks","type":"int32[]"},{"internalType":"uint128[]","name":"amounts","type":"uint128[]"}],"internalType":"struct IMaverickV2Pool.AddLiquidityParams[]","name":"addParams","type":"tuple[]"},{"components":[{"internalType":"uint256","name":"deltaAOut","type":"uint256"},{"internalType":"uint256","name":"deltaBOut","type":"uint256"},{"internalType":"uint256[]","name":"deltaAs","type":"uint256[]"},{"internalType":"uint256[]","name":"deltaBs","type":"uint256[]"}],"internalType":"struct IMaverickV2PoolLens.TickDeltas[]","name":"tickDeltas","type":"tuple[]"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"contract IMaverickV2BoostedPosition","name":"boostedPosition","type":"address"},{"components":[{"internalType":"uint256","name":"slippageFactorD18","type":"uint256"},{"internalType":"uint256","name":"numberOfPriceBreaksPerSide","type":"uint256"},{"internalType":"uint256","name":"targetAmount","type":"uint256"},{"internalType":"bool","name":"targetIsA","type":"bool"}],"internalType":"struct IMaverickV2PoolLens.AddParamsSpecification","name":"addSpec","type":"tuple"}],"name":"getAddLiquidityParamsForBoostedPosition","outputs":[{"internalType":"bytes","name":"packedSqrtPriceBreaks","type":"bytes"},{"internalType":"bytes[]","name":"packedArgs","type":"bytes[]"},{"internalType":"uint88[]","name":"sqrtPriceBreaks","type":"uint88[]"},{"components":[{"internalType":"uint8","name":"kind","type":"uint8"},{"internalType":"int32[]","name":"ticks","type":"int32[]"},{"internalType":"uint128[]","name":"amounts","type":"uint128[]"}],"internalType":"struct IMaverickV2Pool.AddLiquidityParams[]","name":"addParams","type":"tuple[]"},{"components":[{"internalType":"uint256","name":"deltaAOut","type":"uint256"},{"internalType":"uint256","name":"deltaBOut","type":"uint256"},{"internalType":"uint256[]","name":"deltaAs","type":"uint256[]"},{"internalType":"uint256[]","name":"deltaBs","type":"uint256[]"}],"internalType":"struct IMaverickV2PoolLens.TickDeltas[]","name":"tickDeltas","type":"tuple[]"}],"stateMutability":"view","type":"function"},{"inputs":[{"components":[{"internalType":"contract IMaverickV2Pool","name":"pool","type":"address"},{"internalType":"uint32[]","name":"binIds","type":"uint32[]"},{"internalType":"uint128[]","name":"ratios","type":"uint128[]"},{"internalType":"uint8","name":"kind","type":"uint8"}],"internalType":"struct IMaverickV2PoolLens.BoostedPositionSpecification","name":"bpSpec","type":"tuple"},{"components":[{"internalType":"uint256","name":"slippageFactorD18","type":"uint256"},{"internalType":"uint256","name":"numberOfPriceBreaksPerSide","type":"uint256"},{"internalType":"uint256","name":"targetAmount","type":"uint256"},{"internalType":"bool","name":"targetIsA","type":"bool"}],"internalType":"struct IMaverickV2PoolLens.AddParamsSpecification","name":"addSpec","type":"tuple"}],"name":"getCreateBoostedPositionParams","outputs":[{"internalType":"bytes","name":"packedSqrtPriceBreaks","type":"bytes"},{"internalType":"bytes[]","name":"packedArgs","type":"bytes[]"},{"internalType":"uint88[]","name":"sqrtPriceBreaks","type":"uint88[]"},{"components":[{"internalType":"uint8","name":"kind","type":"uint8"},{"internalType":"int32[]","name":"ticks","type":"int32[]"},{"internalType":"uint128[]","name":"amounts","type":"uint128[]"}],"internalType":"struct IMaverickV2Pool.AddLiquidityParams[]","name":"addParams","type":"tuple[]"},{"components":[{"internalType":"uint256","name":"deltaAOut","type":"uint256"},{"internalType":"uint256","name":"deltaBOut","type":"uint256"},{"internalType":"uint256[]","name":"deltaAs","type":"uint256[]"},{"internalType":"uint256[]","name":"deltaBs","type":"uint256[]"}],"internalType":"struct IMaverickV2PoolLens.TickDeltas[]","name":"tickDeltas","type":"tuple[]"}],"stateMutability":"view","type":"function"},{"inputs":[{"components":[{"internalType":"uint64","name":"feeAIn","type":"uint64"},{"internalType":"uint64","name":"feeBIn","type":"uint64"},{"internalType":"uint16","name":"tickSpacing","type":"uint16"},{"internalType":"uint32","name":"lookback","type":"uint32"},{"internalType":"contract IERC20","name":"tokenA","type":"address"},{"internalType":"contract IERC20","name":"tokenB","type":"address"},{"internalType":"int32","name":"activeTick","type":"int32"},{"internalType":"uint8","name":"kinds","type":"uint8"},{"internalType":"uint256","name":"initialTargetB","type":"uint256"},{"internalType":"uint256","name":"sqrtPrice","type":"uint256"},{"internalType":"uint8","name":"kind","type":"uint8"},{"internalType":"int32[]","name":"ticks","type":"int32[]"},{"internalType":"uint128[]","name":"relativeLiquidityAmounts","type":"uint128[]"},{"internalType":"uint256","name":"targetAmount","type":"uint256"},{"internalType":"bool","name":"targetIsA","type":"bool"}],"internalType":"struct IMaverickV2PoolLens.CreateAndAddParamsViewInputs","name":"params","type":"tuple"},{"internalType":"contract IMaverickV2Factory","name":"factory","type":"address"}],"name":"getCreatePoolAtPriceAndAddLiquidityParams","outputs":[{"components":[{"internalType":"uint64","name":"feeAIn","type":"uint64"},{"internalType":"uint64","name":"feeBIn","type":"uint64"},{"internalType":"uint16","name":"tickSpacing","type":"uint16"},{"internalType":"uint32","name":"lookback","type":"uint32"},{"internalType":"contract IERC20","name":"tokenA","type":"address"},{"internalType":"contract IERC20","name":"tokenB","type":"address"},{"internalType":"int32","name":"activeTick","type":"int32"},{"internalType":"uint8","name":"kinds","type":"uint8"},{"components":[{"internalType":"uint8","name":"kind","type":"uint8"},{"internalType":"int32[]","name":"ticks","type":"int32[]"},{"internalType":"uint128[]","name":"amounts","type":"uint128[]"}],"internalType":"struct IMaverickV2Pool.AddLiquidityParams","name":"donateParams","type":"tuple"},{"internalType":"uint256","name":"swapAmount","type":"uint256"},{"components":[{"internalType":"uint8","name":"kind","type":"uint8"},{"internalType":"int32[]","name":"ticks","type":"int32[]"},{"internalType":"uint128[]","name":"amounts","type":"uint128[]"}],"internalType":"struct IMaverickV2Pool.AddLiquidityParams","name":"addParams","type":"tuple"},{"internalType":"bytes[]","name":"packedAddParams","type":"bytes[]"},{"internalType":"uint256","name":"deltaAOut","type":"uint256"},{"internalType":"uint256","name":"deltaBOut","type":"uint256"},{"internalType":"uint256","name":"preAddReserveA","type":"uint256"},{"internalType":"uint256","name":"preAddReserveB","type":"uint256"}],"internalType":"struct IMaverickV2PoolLens.CreateAndAddParamsInputs","name":"output","type":"tuple"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"contract IMaverickV2Pool","name":"pool","type":"address"},{"internalType":"uint32","name":"binStart","type":"uint32"},{"internalType":"uint32","name":"binEnd","type":"uint32"}],"name":"getFullPoolState","outputs":[{"components":[{"components":[{"internalType":"uint128","name":"reserveA","type":"uint128"},{"internalType":"uint128","name":"reserveB","type":"uint128"},{"internalType":"uint128","name":"totalSupply","type":"uint128"},{"internalType":"uint32[4]","name":"binIdsByTick","type":"uint32[4]"}],"internalType":"struct IMaverickV2Pool.TickState[]","name":"tickStateMapping","type":"tuple[]"},{"components":[{"internalType":"uint128","name":"mergeBinBalance","type":"uint128"},{"internalType":"uint128","name":"tickBalance","type":"uint128"},{"internalType":"uint128","name":"totalSupply","type":"uint128"},{"internalType":"uint8","name":"kind","type":"uint8"},{"internalType":"int32","name":"tick","type":"int32"},{"internalType":"uint32","name":"mergeId","type":"uint32"}],"internalType":"struct IMaverickV2Pool.BinState[]","name":"binStateMapping","type":"tuple[]"},{"components":[{"internalType":"uint128[4]","name":"values","type":"uint128[4]"}],"internalType":"struct IMaverickV2PoolLens.BinPositionKinds[]","name":"binIdByTickKindMapping","type":"tuple[]"},{"components":[{"internalType":"uint128","name":"reserveA","type":"uint128"},{"internalType":"uint128","name":"reserveB","type":"uint128"},{"internalType":"int64","name":"lastTwaD8","type":"int64"},{"internalType":"int64","name":"lastLogPriceD8","type":"int64"},{"internalType":"uint40","name":"lastTimestamp","type":"uint40"},{"internalType":"int32","name":"activeTick","type":"int32"},{"internalType":"bool","name":"isLocked","type":"bool"},{"internalType":"uint32","name":"binCounter","type":"uint32"},{"internalType":"uint8","name":"protocolFeeRatioD3","type":"uint8"}],"internalType":"struct IMaverickV2Pool.State","name":"state","type":"tuple"},{"components":[{"internalType":"uint256","name":"amountA","type":"uint256"},{"internalType":"uint256","name":"amountB","type":"uint256"}],"internalType":"struct IMaverickV2PoolLens.Reserves","name":"protocolFees","type":"tuple"}],"internalType":"struct IMaverickV2PoolLens.PoolState","name":"poolState","type":"tuple"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"contract IMaverickV2Pool","name":"pool","type":"address"}],"name":"getPoolPrice","outputs":[{"internalType":"uint256","name":"price","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"contract IMaverickV2Pool","name":"pool","type":"address"}],"name":"getPoolSqrtPrice","outputs":[{"internalType":"uint256","name":"sqrtPrice","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"contract IMaverickV2Pool","name":"pool","type":"address"},{"internalType":"int32","name":"tick","type":"int32"}],"name":"getTickSqrtPriceAndL","outputs":[{"internalType":"uint256","name":"sqrtPrice","type":"uint256"},{"internalType":"uint256","name":"liquidity","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"contract IMaverickV2Pool","name":"pool","type":"address"},{"internalType":"int32","name":"tickStart","type":"int32"},{"internalType":"int32","name":"tickEnd","type":"int32"}],"name":"getTicks","outputs":[{"internalType":"int32[]","name":"ticks","type":"int32[]"},{"components":[{"internalType":"uint128","name":"reserveA","type":"uint128"},{"internalType":"uint128","name":"reserveB","type":"uint128"},{"internalType":"uint128","name":"totalSupply","type":"uint128"},{"internalType":"uint32[4]","name":"binIdsByTick","type":"uint32[4]"}],"internalType":"struct IMaverickV2Pool.TickState[]","name":"tickStates","type":"tuple[]"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"contract IMaverickV2Pool","name":"pool","type":"address"},{"internalType":"int32","name":"tickRadius","type":"int32"}],"name":"getTicksAroundActive","outputs":[{"internalType":"int32[]","name":"ticks","type":"int32[]"},{"components":[{"internalType":"uint128","name":"reserveA","type":"uint128"},{"internalType":"uint128","name":"reserveB","type":"uint128"},{"internalType":"uint128","name":"totalSupply","type":"uint128"},{"internalType":"uint32[4]","name":"binIdsByTick","type":"uint32[4]"}],"internalType":"struct IMaverickV2Pool.TickState[]","name":"tickStates","type":"tuple[]"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"contract IMaverickV2Pool","name":"pool","type":"address"},{"internalType":"int32","name":"tickRadius","type":"int32"}],"name":"getTicksAroundActiveWLiquidity","outputs":[{"internalType":"int32[]","name":"ticks","type":"int32[]"},{"components":[{"internalType":"uint128","name":"reserveA","type":"uint128"},{"internalType":"uint128","name":"reserveB","type":"uint128"},{"internalType":"uint128","name":"totalSupply","type":"uint128"},{"internalType":"uint32[4]","name":"binIdsByTick","type":"uint32[4]"}],"internalType":"struct IMaverickV2Pool.TickState[]","name":"tickStates","type":"tuple[]"},{"internalType":"uint256[]","name":"liquidities","type":"uint256[]"},{"internalType":"uint256[]","name":"sqrtLowerTickPrices","type":"uint256[]"},{"internalType":"uint256[]","name":"sqrtUpperTickPrices","type":"uint256[]"},{"components":[{"internalType":"uint128","name":"reserveA","type":"uint128"},{"internalType":"uint128","name":"reserveB","type":"uint128"},{"internalType":"int64","name":"lastTwaD8","type":"int64"},{"internalType":"int64","name":"lastLogPriceD8","type":"int64"},{"internalType":"uint40","name":"lastTimestamp","type":"uint40"},{"internalType":"int32","name":"activeTick","type":"int32"},{"internalType":"bool","name":"isLocked","type":"bool"},{"internalType":"uint32","name":"binCounter","type":"uint32"},{"internalType":"uint8","name":"protocolFeeRatioD3","type":"uint8"}],"internalType":"struct IMaverickV2Pool.State","name":"poolState","type":"tuple"},{"internalType":"uint256","name":"sqrtPrice","type":"uint256"},{"internalType":"uint256","name":"feeAIn","type":"uint256"},{"internalType":"uint256","name":"feeBIn","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"contract IMaverickV2Pool","name":"pool","type":"address"}],"name":"tokenScales","outputs":[{"internalType":"uint256","name":"tokenAScale","type":"uint256"},{"internalType":"uint256","name":"tokenBScale","type":"uint256"}],"stateMutability":"view","type":"function"}]')
    abi_2 = json.loads("[{\"inputs\":[{\"internalType\":\"address\",\"name\":\"_l2Bridge\",\"type\":\"address\"},{\"internalType\":\"address\",\"name\":\"_l1Token\",\"type\":\"address\"},{\"internalType\":\"string\",\"name\":\"_name\",\"type\":\"string\"},{\"internalType\":\"string\",\"name\":\"_symbol\",\"type\":\"string\"}],\"stateMutability\":\"nonpayable\",\"type\":\"constructor\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"internalType\":\"address\",\"name\":\"owner\",\"type\":\"address\"},{\"indexed\":true,\"internalType\":\"address\",\"name\":\"spender\",\"type\":\"address\"},{\"indexed\":false,\"internalType\":\"uint256\",\"name\":\"value\",\"type\":\"uint256\"}],\"name\":\"Approval\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"internalType\":\"address\",\"name\":\"_account\",\"type\":\"address\"},{\"indexed\":false,\"internalType\":\"uint256\",\"name\":\"_amount\",\"type\":\"uint256\"}],\"name\":\"Burn\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"internalType\":\"address\",\"name\":\"_account\",\"type\":\"address\"},{\"indexed\":false,\"internalType\":\"uint256\",\"name\":\"_amount\",\"type\":\"uint256\"}],\"name\":\"Mint\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"internalType\":\"address\",\"name\":\"from\",\"type\":\"address\"},{\"indexed\":true,\"internalType\":\"address\",\"name\":\"to\",\"type\":\"address\"},{\"indexed\":false,\"internalType\":\"uint256\",\"name\":\"value\",\"type\":\"uint256\"}],\"name\":\"Transfer\",\"type\":\"event\"},{\"inputs\":[{\"internalType\":\"address\",\"name\":\"owner\",\"type\":\"address\"},{\"internalType\":\"address\",\"name\":\"spender\",\"type\":\"address\"}],\"name\":\"allowance\",\"outputs\":[{\"internalType\":\"uint256\",\"name\":\"\",\"type\":\"uint256\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"address\",\"name\":\"spender\",\"type\":\"address\"},{\"internalType\":\"uint256\",\"name\":\"amount\",\"type\":\"uint256\"}],\"name\":\"approve\",\"outputs\":[{\"internalType\":\"bool\",\"name\":\"\",\"type\":\"bool\"}],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"address\",\"name\":\"account\",\"type\":\"address\"}],\"name\":\"balanceOf\",\"outputs\":[{\"internalType\":\"uint256\",\"name\":\"\",\"type\":\"uint256\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"address\",\"name\":\"_from\",\"type\":\"address\"},{\"internalType\":\"uint256\",\"name\":\"_amount\",\"type\":\"uint256\"}],\"name\":\"burn\",\"outputs\":[],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"decimals\",\"outputs\":[{\"internalType\":\"uint8\",\"name\":\"\",\"type\":\"uint8\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"address\",\"name\":\"spender\",\"type\":\"address\"},{\"internalType\":\"uint256\",\"name\":\"subtractedValue\",\"type\":\"uint256\"}],\"name\":\"decreaseAllowance\",\"outputs\":[{\"internalType\":\"bool\",\"name\":\"\",\"type\":\"bool\"}],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"address\",\"name\":\"spender\",\"type\":\"address\"},{\"internalType\":\"uint256\",\"name\":\"addedValue\",\"type\":\"uint256\"}],\"name\":\"increaseAllowance\",\"outputs\":[{\"internalType\":\"bool\",\"name\":\"\",\"type\":\"bool\"}],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"l1Token\",\"outputs\":[{\"internalType\":\"address\",\"name\":\"\",\"type\":\"address\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"l2Bridge\",\"outputs\":[{\"internalType\":\"address\",\"name\":\"\",\"type\":\"address\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"address\",\"name\":\"_to\",\"type\":\"address\"},{\"internalType\":\"uint256\",\"name\":\"_amount\",\"type\":\"uint256\"}],\"name\":\"mint\",\"outputs\":[],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"name\",\"outputs\":[{\"internalType\":\"string\",\"name\":\"\",\"type\":\"string\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"bytes4\",\"name\":\"_interfaceId\",\"type\":\"bytes4\"}],\"name\":\"supportsInterface\",\"outputs\":[{\"internalType\":\"bool\",\"name\":\"\",\"type\":\"bool\"}],\"stateMutability\":\"pure\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"symbol\",\"outputs\":[{\"internalType\":\"string\",\"name\":\"\",\"type\":\"string\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"totalSupply\",\"outputs\":[{\"internalType\":\"uint256\",\"name\":\"\",\"type\":\"uint256\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"address\",\"name\":\"recipient\",\"type\":\"address\"},{\"internalType\":\"uint256\",\"name\":\"amount\",\"type\":\"uint256\"}],\"name\":\"transfer\",\"outputs\":[{\"internalType\":\"bool\",\"name\":\"\",\"type\":\"bool\"}],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"address\",\"name\":\"sender\",\"type\":\"address\"},{\"internalType\":\"address\",\"name\":\"recipient\",\"type\":\"address\"},{\"internalType\":\"uint256\",\"name\":\"amount\",\"type\":\"uint256\"}],\"name\":\"transferFrom\",\"outputs\":[{\"internalType\":\"bool\",\"name\":\"\",\"type\":\"bool\"}],\"stateMutability\":\"nonpayable\",\"type\":\"function\"}]")
    
    contract_address = "0x942646b0A8B42Af1e1044439013436a9a3e080b5"
    
    address = Web3.to_checksum_address(contract_address)
    contract = web3.eth.contract( address = address, abi = abi_1 )
    
    # pool_address ABI
    pool_address = Web3.to_checksum_address(pool_address) 
    pool_abi = json.loads('[{"inputs":[],"stateMutability":"nonpayable","type":"constructor"},{"inputs":[],"name":"MathOverflowedMulDiv","type":"error"},{"inputs":[{"internalType":"uint256","name":"binIdsLength","type":"uint256"},{"internalType":"uint256","name":"amountsLength","type":"uint256"}],"name":"PoolBinIdsAmountsLengthMismatch","type":"error"},{"inputs":[{"internalType":"int32","name":"startingTick","type":"int32"}],"name":"PoolCurrentTickBeyondSwapLimit","type":"error"},{"inputs":[],"name":"PoolFunctionNotImplemented","type":"error"},{"inputs":[{"internalType":"uint256","name":"deltaLpAmount","type":"uint256"},{"internalType":"uint256","name":"accountBalance","type":"uint256"}],"name":"PoolInsufficientBalance","type":"error"},{"inputs":[],"name":"PoolInvalidFee","type":"error"},{"inputs":[{"internalType":"uint256","name":"kinds","type":"uint256"},{"internalType":"uint256","name":"kind","type":"uint256"}],"name":"PoolKindNotSupported","type":"error"},{"inputs":[],"name":"PoolLocked","type":"error"},{"inputs":[],"name":"PoolMigrateBinFirst","type":"error"},{"inputs":[],"name":"PoolMinimumLiquidityNotMet","type":"error"},{"inputs":[{"internalType":"uint256","name":"amount","type":"uint256"}],"name":"PoolReservesExceedMaximum","type":"error"},{"inputs":[{"internalType":"address","name":"sender_","type":"address"},{"internalType":"address","name":"accessor","type":"address"}],"name":"PoolSenderNotAccessor","type":"error"},{"inputs":[{"internalType":"address","name":"sender_","type":"address"},{"internalType":"address","name":"accessor","type":"address"}],"name":"PoolSenderNotFactory","type":"error"},{"inputs":[{"internalType":"uint256","name":"tick","type":"uint256"}],"name":"PoolTickMaxExceeded","type":"error"},{"inputs":[{"internalType":"uint256","name":"ticksLength","type":"uint256"},{"internalType":"uint256","name":"amountsLength","type":"uint256"}],"name":"PoolTicksAmountsLengthMismatch","type":"error"},{"inputs":[{"internalType":"uint256","name":"index","type":"uint256"},{"internalType":"int256","name":"previousTick","type":"int256"},{"internalType":"int256","name":"tick","type":"int256"}],"name":"PoolTicksNotSorted","type":"error"},{"inputs":[{"internalType":"uint256","name":"internalReserve","type":"uint256"},{"internalType":"uint256","name":"tokenBalance","type":"uint256"},{"internalType":"contract IERC20","name":"token","type":"address"}],"name":"PoolTokenNotSolvent","type":"error"},{"inputs":[{"internalType":"uint256","name":"amount","type":"uint256"},{"internalType":"uint256","name":"bits","type":"uint256"}],"name":"PoolValueExceedsBits","type":"error"},{"inputs":[],"name":"PoolZeroLiquidityAdded","type":"error"},{"inputs":[{"internalType":"uint8","name":"bits","type":"uint8"},{"internalType":"uint256","name":"value","type":"uint256"}],"name":"SafeCastOverflowedUintDowncast","type":"error"},{"inputs":[{"internalType":"int256","name":"tick","type":"int256"}],"name":"TickMaxExceeded","type":"error"},{"inputs":[{"internalType":"contract IERC20","name":"token","type":"address"},{"internalType":"address","name":"to","type":"address"},{"internalType":"uint256","name":"amount","type":"uint256"}],"name":"TransferFailed","type":"error"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"address","name":"sender","type":"address"},{"indexed":false,"internalType":"address","name":"recipient","type":"address"},{"indexed":false,"internalType":"uint256","name":"subaccount","type":"uint256"},{"components":[{"internalType":"uint8","name":"kind","type":"uint8"},{"internalType":"int32[]","name":"ticks","type":"int32[]"},{"internalType":"uint128[]","name":"amounts","type":"uint128[]"}],"indexed":false,"internalType":"struct IMaverickV2Pool.AddLiquidityParams","name":"params","type":"tuple"},{"indexed":false,"internalType":"uint256","name":"tokenAAmount","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"tokenBAmount","type":"uint256"},{"indexed":false,"internalType":"uint32[]","name":"binIds","type":"uint32[]"}],"name":"PoolAddLiquidity","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"address","name":"sender","type":"address"},{"indexed":false,"internalType":"uint32","name":"binId","type":"uint32"},{"indexed":false,"internalType":"uint32","name":"maxRecursion","type":"uint32"}],"name":"PoolMigrateBinsUpStack","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"uint256","name":"feeCollected","type":"uint256"},{"indexed":false,"internalType":"bool","name":"isTokenA","type":"bool"}],"name":"PoolProtocolFeeCollected","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"address","name":"sender","type":"address"},{"indexed":false,"internalType":"address","name":"recipient","type":"address"},{"indexed":false,"internalType":"uint256","name":"subaccount","type":"uint256"},{"components":[{"internalType":"uint32[]","name":"binIds","type":"uint32[]"},{"internalType":"uint128[]","name":"amounts","type":"uint128[]"}],"indexed":false,"internalType":"struct IMaverickV2Pool.RemoveLiquidityParams","name":"params","type":"tuple"},{"indexed":false,"internalType":"uint256","name":"tokenAOut","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"tokenBOut","type":"uint256"}],"name":"PoolRemoveLiquidity","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"uint256","name":"lendingFeeRateD18","type":"uint256"}],"name":"PoolSetLendingFeeRate","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"uint256","name":"protocolFeeRatioD3","type":"uint256"}],"name":"PoolSetProtocolFeeRatio","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"uint256","name":"newFeeAIn","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"newFeeBIn","type":"uint256"}],"name":"PoolSetVariableFee","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"address","name":"sender","type":"address"},{"indexed":false,"internalType":"address","name":"recipient","type":"address"},{"components":[{"internalType":"uint256","name":"amount","type":"uint256"},{"internalType":"bool","name":"tokenAIn","type":"bool"},{"internalType":"bool","name":"exactOutput","type":"bool"},{"internalType":"int32","name":"tickLimit","type":"int32"}],"indexed":false,"internalType":"struct IMaverickV2Pool.SwapParams","name":"params","type":"tuple"},{"indexed":false,"internalType":"uint256","name":"amountIn","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"amountOut","type":"uint256"}],"name":"PoolSwap","type":"event"},{"inputs":[],"name":"accessor","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"recipient","type":"address"},{"internalType":"uint256","name":"subaccount","type":"uint256"},{"components":[{"internalType":"uint8","name":"kind","type":"uint8"},{"internalType":"int32[]","name":"ticks","type":"int32[]"},{"internalType":"uint128[]","name":"amounts","type":"uint128[]"}],"internalType":"struct IMaverickV2Pool.AddLiquidityParams","name":"params","type":"tuple"},{"internalType":"bytes","name":"data","type":"bytes"}],"name":"addLiquidity","outputs":[{"internalType":"uint256","name":"tokenAAmount","type":"uint256"},{"internalType":"uint256","name":"tokenBAmount","type":"uint256"},{"internalType":"uint32[]","name":"binIds","type":"uint32[]"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"enum IMaverickV2PoolAdmin.AdminAction","name":"action","type":"uint8"},{"internalType":"uint256","name":"value","type":"uint256"}],"name":"adminAction","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"user","type":"address"},{"internalType":"uint256","name":"subaccount","type":"uint256"},{"internalType":"uint32","name":"binId","type":"uint32"}],"name":"balanceOf","outputs":[{"internalType":"uint128","name":"lpBalance","type":"uint128"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"int32","name":"tick","type":"int32"},{"internalType":"uint256","name":"kind","type":"uint256"}],"name":"binIdByTickKind","outputs":[{"internalType":"uint32","name":"binId","type":"uint32"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"factory","outputs":[{"internalType":"contract IMaverickV2Factory","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"bool","name":"tokenAIn","type":"bool"}],"name":"fee","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"recipient","type":"address"},{"internalType":"uint256","name":"amountA","type":"uint256"},{"internalType":"uint256","name":"amountB","type":"uint256"},{"internalType":"bytes","name":"data","type":"bytes"}],"name":"flashLoan","outputs":[{"internalType":"uint128","name":"lendingFeeA","type":"uint128"},{"internalType":"uint128","name":"lendingFeeB","type":"uint128"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint32","name":"binId","type":"uint32"}],"name":"getBin","outputs":[{"components":[{"internalType":"uint128","name":"mergeBinBalance","type":"uint128"},{"internalType":"uint128","name":"tickBalance","type":"uint128"},{"internalType":"uint128","name":"totalSupply","type":"uint128"},{"internalType":"uint8","name":"kind","type":"uint8"},{"internalType":"int32","name":"tick","type":"int32"},{"internalType":"uint32","name":"mergeId","type":"uint32"}],"internalType":"struct IMaverickV2Pool.BinState","name":"bin","type":"tuple"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"getCurrentTwa","outputs":[{"internalType":"int256","name":"","type":"int256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"getState","outputs":[{"components":[{"internalType":"uint128","name":"reserveA","type":"uint128"},{"internalType":"uint128","name":"reserveB","type":"uint128"},{"internalType":"int64","name":"lastTwaD8","type":"int64"},{"internalType":"int64","name":"lastLogPriceD8","type":"int64"},{"internalType":"uint40","name":"lastTimestamp","type":"uint40"},{"internalType":"int32","name":"activeTick","type":"int32"},{"internalType":"bool","name":"isLocked","type":"bool"},{"internalType":"uint32","name":"binCounter","type":"uint32"},{"internalType":"uint8","name":"protocolFeeRatioD3","type":"uint8"}],"internalType":"struct IMaverickV2Pool.State","name":"","type":"tuple"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"int32","name":"tick","type":"int32"}],"name":"getTick","outputs":[{"components":[{"internalType":"uint128","name":"reserveA","type":"uint128"},{"internalType":"uint128","name":"reserveB","type":"uint128"},{"internalType":"uint128","name":"totalSupply","type":"uint128"},{"internalType":"uint32[4]","name":"binIdsByTick","type":"uint32[4]"}],"internalType":"struct IMaverickV2Pool.TickState","name":"_tick","type":"tuple"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"kinds","outputs":[{"internalType":"uint8","name":"_kinds","type":"uint8"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"lendingFeeRateD18","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"lookback","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint32","name":"binId","type":"uint32"},{"internalType":"uint32","name":"maxRecursion","type":"uint32"}],"name":"migrateBinUpStack","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"permissionedLiquidity","outputs":[{"internalType":"bool","name":"_permissionedLiquidity","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"permissionedPool","outputs":[{"internalType":"bool","name":"_permissionedPool","type":"bool"}],"stateMutability":"pure","type":"function"},{"inputs":[],"name":"permissionedSwap","outputs":[{"internalType":"bool","name":"_permissionedSwap","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"protocolFeeA","outputs":[{"internalType":"uint128","name":"","type":"uint128"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"protocolFeeB","outputs":[{"internalType":"uint128","name":"","type":"uint128"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"recipient","type":"address"},{"internalType":"uint256","name":"subaccount","type":"uint256"},{"components":[{"internalType":"uint32[]","name":"binIds","type":"uint32[]"},{"internalType":"uint128[]","name":"amounts","type":"uint128[]"}],"internalType":"struct IMaverickV2Pool.RemoveLiquidityParams","name":"params","type":"tuple"}],"name":"removeLiquidity","outputs":[{"internalType":"uint256","name":"tokenAOut","type":"uint256"},{"internalType":"uint256","name":"tokenBOut","type":"uint256"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"","type":"uint256"},{"internalType":"uint256","name":"","type":"uint256"}],"name":"setFee","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"recipient","type":"address"},{"components":[{"internalType":"uint256","name":"amount","type":"uint256"},{"internalType":"bool","name":"tokenAIn","type":"bool"},{"internalType":"bool","name":"exactOutput","type":"bool"},{"internalType":"int32","name":"tickLimit","type":"int32"}],"internalType":"struct IMaverickV2Pool.SwapParams","name":"params","type":"tuple"},{"internalType":"bytes","name":"data","type":"bytes"}],"name":"swap","outputs":[{"internalType":"uint256","name":"amountIn","type":"uint256"},{"internalType":"uint256","name":"amountOut","type":"uint256"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"tickSpacing","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"tokenA","outputs":[{"internalType":"contract IERC20","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"tokenAScale","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"tokenB","outputs":[{"internalType":"contract IERC20","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"tokenBScale","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"}]')
    pool_contract =  web3.eth.contract( address = pool_address, abi = pool_abi )
    
    
    # GHO 0x40D16FC0246aD3160Ccc09B8D0D3A2cD28aE6C2f
    address0 = pool_contract.functions.tokenA().call() 
    # USDC 0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48 
    address1 = pool_contract.functions.tokenB().call()
    
    token_0 ={} 
    if address0 != '0x0000000000000000000000000000000000000000':           
        address0 = Web3.to_checksum_address(address0)
        contract = web3.eth.contract( address = address0, abi = abi_2 )
        token_0['decimals'] = contract.functions.decimals().call()
        token_0['symbol'] = contract.functions.symbol().call()
    else:
        token_0['decimals'] = 18
        token_0['symbol'] = 'ETH'
        
    token_1 ={} 
    if address1 != '0x0000000000000000000000000000000000000000':  
        address1 = Web3.to_checksum_address(address1)
        contract = web3.eth.contract( address = address1, abi = abi_2 )
        token_1['decimals'] = contract.functions.decimals().call()
        token_1['symbol'] = contract.functions.symbol().call()
    else:
        token_1['decimals'] = 18
        token_1['symbol'] = 'ETH'
        
    dict_token_info ={}
    dict_token_info['token_0'] = token_0
    dict_token_info['token_1'] = token_1
    return dict_token_info


def state_price_maverick_v2(pool_address,dict_token_info):
    
    abi_1 = json.loads('[{"inputs":[{"internalType":"uint256","name":"targetSqrtPrice","type":"uint256"},{"internalType":"uint256","name":"sqrtLowerTickPrice","type":"uint256"},{"internalType":"uint256","name":"sqrtUpperTickPrice","type":"uint256"}],"name":"LensTargetPriceOutOfBounds","type":"error"},{"inputs":[{"internalType":"bool","name":"targetIsA","type":"bool"},{"internalType":"uint256","name":"deltaA","type":"uint256"},{"internalType":"uint256","name":"deltaB","type":"uint256"}],"name":"LensTargetingTokenWithNoDelta","type":"error"},{"inputs":[{"internalType":"uint256","name":"relativeLiquidityAmount","type":"uint256"},{"internalType":"uint256","name":"deltaA","type":"uint256"},{"internalType":"uint256","name":"deltaB","type":"uint256"}],"name":"LensTooLittleLiquidity","type":"error"},{"inputs":[],"name":"LiquidityUtilitiesFailedToFindDeltaAmounts","type":"error"},{"inputs":[{"internalType":"uint256","name":"initialTargetB","type":"uint256"},{"internalType":"uint256","name":"deltaLpBalance","type":"uint256"},{"internalType":"uint256","name":"minimumRequiredLpBalance","type":"uint256"}],"name":"LiquidityUtilitiesInitialTargetBTooSmall","type":"error"},{"inputs":[],"name":"LiquidityUtilitiesNoSwapLiquidity","type":"error"},{"inputs":[{"internalType":"uint256","name":"targetSqrtPrice","type":"uint256"},{"internalType":"uint256","name":"sqrtLowerTickPrice","type":"uint256"},{"internalType":"uint256","name":"sqrtUpperTickPrice","type":"uint256"}],"name":"LiquidityUtilitiesTargetPriceOutOfBounds","type":"error"},{"inputs":[],"name":"MathOverflowedMulDiv","type":"error"},{"inputs":[{"internalType":"uint8","name":"bits","type":"uint8"},{"internalType":"uint256","name":"value","type":"uint256"}],"name":"SafeCastOverflowedUintDowncast","type":"error"},{"inputs":[{"internalType":"int256","name":"tick","type":"int256"}],"name":"TickMaxExceeded","type":"error"},{"inputs":[{"components":[{"internalType":"contract IMaverickV2Pool","name":"pool","type":"address"},{"internalType":"uint8","name":"kind","type":"uint8"},{"internalType":"int32[]","name":"ticks","type":"int32[]"},{"internalType":"uint128[]","name":"relativeLiquidityAmounts","type":"uint128[]"},{"components":[{"internalType":"uint256","name":"slippageFactorD18","type":"uint256"},{"internalType":"uint256","name":"numberOfPriceBreaksPerSide","type":"uint256"},{"internalType":"uint256","name":"targetAmount","type":"uint256"},{"internalType":"bool","name":"targetIsA","type":"bool"}],"internalType":"struct IMaverickV2PoolLens.AddParamsSpecification","name":"addSpec","type":"tuple"}],"internalType":"struct IMaverickV2PoolLens.AddParamsViewInputs","name":"params","type":"tuple"}],"name":"getAddLiquidityParams","outputs":[{"internalType":"bytes","name":"packedSqrtPriceBreaks","type":"bytes"},{"internalType":"bytes[]","name":"packedArgs","type":"bytes[]"},{"internalType":"uint88[]","name":"sqrtPriceBreaks","type":"uint88[]"},{"components":[{"internalType":"uint8","name":"kind","type":"uint8"},{"internalType":"int32[]","name":"ticks","type":"int32[]"},{"internalType":"uint128[]","name":"amounts","type":"uint128[]"}],"internalType":"struct IMaverickV2Pool.AddLiquidityParams[]","name":"addParams","type":"tuple[]"},{"components":[{"internalType":"uint256","name":"deltaAOut","type":"uint256"},{"internalType":"uint256","name":"deltaBOut","type":"uint256"},{"internalType":"uint256[]","name":"deltaAs","type":"uint256[]"},{"internalType":"uint256[]","name":"deltaBs","type":"uint256[]"}],"internalType":"struct IMaverickV2PoolLens.TickDeltas[]","name":"tickDeltas","type":"tuple[]"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"contract IMaverickV2BoostedPosition","name":"boostedPosition","type":"address"},{"components":[{"internalType":"uint256","name":"slippageFactorD18","type":"uint256"},{"internalType":"uint256","name":"numberOfPriceBreaksPerSide","type":"uint256"},{"internalType":"uint256","name":"targetAmount","type":"uint256"},{"internalType":"bool","name":"targetIsA","type":"bool"}],"internalType":"struct IMaverickV2PoolLens.AddParamsSpecification","name":"addSpec","type":"tuple"}],"name":"getAddLiquidityParamsForBoostedPosition","outputs":[{"internalType":"bytes","name":"packedSqrtPriceBreaks","type":"bytes"},{"internalType":"bytes[]","name":"packedArgs","type":"bytes[]"},{"internalType":"uint88[]","name":"sqrtPriceBreaks","type":"uint88[]"},{"components":[{"internalType":"uint8","name":"kind","type":"uint8"},{"internalType":"int32[]","name":"ticks","type":"int32[]"},{"internalType":"uint128[]","name":"amounts","type":"uint128[]"}],"internalType":"struct IMaverickV2Pool.AddLiquidityParams[]","name":"addParams","type":"tuple[]"},{"components":[{"internalType":"uint256","name":"deltaAOut","type":"uint256"},{"internalType":"uint256","name":"deltaBOut","type":"uint256"},{"internalType":"uint256[]","name":"deltaAs","type":"uint256[]"},{"internalType":"uint256[]","name":"deltaBs","type":"uint256[]"}],"internalType":"struct IMaverickV2PoolLens.TickDeltas[]","name":"tickDeltas","type":"tuple[]"}],"stateMutability":"view","type":"function"},{"inputs":[{"components":[{"internalType":"contract IMaverickV2Pool","name":"pool","type":"address"},{"internalType":"uint32[]","name":"binIds","type":"uint32[]"},{"internalType":"uint128[]","name":"ratios","type":"uint128[]"},{"internalType":"uint8","name":"kind","type":"uint8"}],"internalType":"struct IMaverickV2PoolLens.BoostedPositionSpecification","name":"bpSpec","type":"tuple"},{"components":[{"internalType":"uint256","name":"slippageFactorD18","type":"uint256"},{"internalType":"uint256","name":"numberOfPriceBreaksPerSide","type":"uint256"},{"internalType":"uint256","name":"targetAmount","type":"uint256"},{"internalType":"bool","name":"targetIsA","type":"bool"}],"internalType":"struct IMaverickV2PoolLens.AddParamsSpecification","name":"addSpec","type":"tuple"}],"name":"getCreateBoostedPositionParams","outputs":[{"internalType":"bytes","name":"packedSqrtPriceBreaks","type":"bytes"},{"internalType":"bytes[]","name":"packedArgs","type":"bytes[]"},{"internalType":"uint88[]","name":"sqrtPriceBreaks","type":"uint88[]"},{"components":[{"internalType":"uint8","name":"kind","type":"uint8"},{"internalType":"int32[]","name":"ticks","type":"int32[]"},{"internalType":"uint128[]","name":"amounts","type":"uint128[]"}],"internalType":"struct IMaverickV2Pool.AddLiquidityParams[]","name":"addParams","type":"tuple[]"},{"components":[{"internalType":"uint256","name":"deltaAOut","type":"uint256"},{"internalType":"uint256","name":"deltaBOut","type":"uint256"},{"internalType":"uint256[]","name":"deltaAs","type":"uint256[]"},{"internalType":"uint256[]","name":"deltaBs","type":"uint256[]"}],"internalType":"struct IMaverickV2PoolLens.TickDeltas[]","name":"tickDeltas","type":"tuple[]"}],"stateMutability":"view","type":"function"},{"inputs":[{"components":[{"internalType":"uint64","name":"feeAIn","type":"uint64"},{"internalType":"uint64","name":"feeBIn","type":"uint64"},{"internalType":"uint16","name":"tickSpacing","type":"uint16"},{"internalType":"uint32","name":"lookback","type":"uint32"},{"internalType":"contract IERC20","name":"tokenA","type":"address"},{"internalType":"contract IERC20","name":"tokenB","type":"address"},{"internalType":"int32","name":"activeTick","type":"int32"},{"internalType":"uint8","name":"kinds","type":"uint8"},{"internalType":"uint256","name":"initialTargetB","type":"uint256"},{"internalType":"uint256","name":"sqrtPrice","type":"uint256"},{"internalType":"uint8","name":"kind","type":"uint8"},{"internalType":"int32[]","name":"ticks","type":"int32[]"},{"internalType":"uint128[]","name":"relativeLiquidityAmounts","type":"uint128[]"},{"internalType":"uint256","name":"targetAmount","type":"uint256"},{"internalType":"bool","name":"targetIsA","type":"bool"}],"internalType":"struct IMaverickV2PoolLens.CreateAndAddParamsViewInputs","name":"params","type":"tuple"},{"internalType":"contract IMaverickV2Factory","name":"factory","type":"address"}],"name":"getCreatePoolAtPriceAndAddLiquidityParams","outputs":[{"components":[{"internalType":"uint64","name":"feeAIn","type":"uint64"},{"internalType":"uint64","name":"feeBIn","type":"uint64"},{"internalType":"uint16","name":"tickSpacing","type":"uint16"},{"internalType":"uint32","name":"lookback","type":"uint32"},{"internalType":"contract IERC20","name":"tokenA","type":"address"},{"internalType":"contract IERC20","name":"tokenB","type":"address"},{"internalType":"int32","name":"activeTick","type":"int32"},{"internalType":"uint8","name":"kinds","type":"uint8"},{"components":[{"internalType":"uint8","name":"kind","type":"uint8"},{"internalType":"int32[]","name":"ticks","type":"int32[]"},{"internalType":"uint128[]","name":"amounts","type":"uint128[]"}],"internalType":"struct IMaverickV2Pool.AddLiquidityParams","name":"donateParams","type":"tuple"},{"internalType":"uint256","name":"swapAmount","type":"uint256"},{"components":[{"internalType":"uint8","name":"kind","type":"uint8"},{"internalType":"int32[]","name":"ticks","type":"int32[]"},{"internalType":"uint128[]","name":"amounts","type":"uint128[]"}],"internalType":"struct IMaverickV2Pool.AddLiquidityParams","name":"addParams","type":"tuple"},{"internalType":"bytes[]","name":"packedAddParams","type":"bytes[]"},{"internalType":"uint256","name":"deltaAOut","type":"uint256"},{"internalType":"uint256","name":"deltaBOut","type":"uint256"},{"internalType":"uint256","name":"preAddReserveA","type":"uint256"},{"internalType":"uint256","name":"preAddReserveB","type":"uint256"}],"internalType":"struct IMaverickV2PoolLens.CreateAndAddParamsInputs","name":"output","type":"tuple"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"contract IMaverickV2Pool","name":"pool","type":"address"},{"internalType":"uint32","name":"binStart","type":"uint32"},{"internalType":"uint32","name":"binEnd","type":"uint32"}],"name":"getFullPoolState","outputs":[{"components":[{"components":[{"internalType":"uint128","name":"reserveA","type":"uint128"},{"internalType":"uint128","name":"reserveB","type":"uint128"},{"internalType":"uint128","name":"totalSupply","type":"uint128"},{"internalType":"uint32[4]","name":"binIdsByTick","type":"uint32[4]"}],"internalType":"struct IMaverickV2Pool.TickState[]","name":"tickStateMapping","type":"tuple[]"},{"components":[{"internalType":"uint128","name":"mergeBinBalance","type":"uint128"},{"internalType":"uint128","name":"tickBalance","type":"uint128"},{"internalType":"uint128","name":"totalSupply","type":"uint128"},{"internalType":"uint8","name":"kind","type":"uint8"},{"internalType":"int32","name":"tick","type":"int32"},{"internalType":"uint32","name":"mergeId","type":"uint32"}],"internalType":"struct IMaverickV2Pool.BinState[]","name":"binStateMapping","type":"tuple[]"},{"components":[{"internalType":"uint128[4]","name":"values","type":"uint128[4]"}],"internalType":"struct IMaverickV2PoolLens.BinPositionKinds[]","name":"binIdByTickKindMapping","type":"tuple[]"},{"components":[{"internalType":"uint128","name":"reserveA","type":"uint128"},{"internalType":"uint128","name":"reserveB","type":"uint128"},{"internalType":"int64","name":"lastTwaD8","type":"int64"},{"internalType":"int64","name":"lastLogPriceD8","type":"int64"},{"internalType":"uint40","name":"lastTimestamp","type":"uint40"},{"internalType":"int32","name":"activeTick","type":"int32"},{"internalType":"bool","name":"isLocked","type":"bool"},{"internalType":"uint32","name":"binCounter","type":"uint32"},{"internalType":"uint8","name":"protocolFeeRatioD3","type":"uint8"}],"internalType":"struct IMaverickV2Pool.State","name":"state","type":"tuple"},{"components":[{"internalType":"uint256","name":"amountA","type":"uint256"},{"internalType":"uint256","name":"amountB","type":"uint256"}],"internalType":"struct IMaverickV2PoolLens.Reserves","name":"protocolFees","type":"tuple"}],"internalType":"struct IMaverickV2PoolLens.PoolState","name":"poolState","type":"tuple"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"contract IMaverickV2Pool","name":"pool","type":"address"}],"name":"getPoolPrice","outputs":[{"internalType":"uint256","name":"price","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"contract IMaverickV2Pool","name":"pool","type":"address"}],"name":"getPoolSqrtPrice","outputs":[{"internalType":"uint256","name":"sqrtPrice","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"contract IMaverickV2Pool","name":"pool","type":"address"},{"internalType":"int32","name":"tick","type":"int32"}],"name":"getTickSqrtPriceAndL","outputs":[{"internalType":"uint256","name":"sqrtPrice","type":"uint256"},{"internalType":"uint256","name":"liquidity","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"contract IMaverickV2Pool","name":"pool","type":"address"},{"internalType":"int32","name":"tickStart","type":"int32"},{"internalType":"int32","name":"tickEnd","type":"int32"}],"name":"getTicks","outputs":[{"internalType":"int32[]","name":"ticks","type":"int32[]"},{"components":[{"internalType":"uint128","name":"reserveA","type":"uint128"},{"internalType":"uint128","name":"reserveB","type":"uint128"},{"internalType":"uint128","name":"totalSupply","type":"uint128"},{"internalType":"uint32[4]","name":"binIdsByTick","type":"uint32[4]"}],"internalType":"struct IMaverickV2Pool.TickState[]","name":"tickStates","type":"tuple[]"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"contract IMaverickV2Pool","name":"pool","type":"address"},{"internalType":"int32","name":"tickRadius","type":"int32"}],"name":"getTicksAroundActive","outputs":[{"internalType":"int32[]","name":"ticks","type":"int32[]"},{"components":[{"internalType":"uint128","name":"reserveA","type":"uint128"},{"internalType":"uint128","name":"reserveB","type":"uint128"},{"internalType":"uint128","name":"totalSupply","type":"uint128"},{"internalType":"uint32[4]","name":"binIdsByTick","type":"uint32[4]"}],"internalType":"struct IMaverickV2Pool.TickState[]","name":"tickStates","type":"tuple[]"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"contract IMaverickV2Pool","name":"pool","type":"address"},{"internalType":"int32","name":"tickRadius","type":"int32"}],"name":"getTicksAroundActiveWLiquidity","outputs":[{"internalType":"int32[]","name":"ticks","type":"int32[]"},{"components":[{"internalType":"uint128","name":"reserveA","type":"uint128"},{"internalType":"uint128","name":"reserveB","type":"uint128"},{"internalType":"uint128","name":"totalSupply","type":"uint128"},{"internalType":"uint32[4]","name":"binIdsByTick","type":"uint32[4]"}],"internalType":"struct IMaverickV2Pool.TickState[]","name":"tickStates","type":"tuple[]"},{"internalType":"uint256[]","name":"liquidities","type":"uint256[]"},{"internalType":"uint256[]","name":"sqrtLowerTickPrices","type":"uint256[]"},{"internalType":"uint256[]","name":"sqrtUpperTickPrices","type":"uint256[]"},{"components":[{"internalType":"uint128","name":"reserveA","type":"uint128"},{"internalType":"uint128","name":"reserveB","type":"uint128"},{"internalType":"int64","name":"lastTwaD8","type":"int64"},{"internalType":"int64","name":"lastLogPriceD8","type":"int64"},{"internalType":"uint40","name":"lastTimestamp","type":"uint40"},{"internalType":"int32","name":"activeTick","type":"int32"},{"internalType":"bool","name":"isLocked","type":"bool"},{"internalType":"uint32","name":"binCounter","type":"uint32"},{"internalType":"uint8","name":"protocolFeeRatioD3","type":"uint8"}],"internalType":"struct IMaverickV2Pool.State","name":"poolState","type":"tuple"},{"internalType":"uint256","name":"sqrtPrice","type":"uint256"},{"internalType":"uint256","name":"feeAIn","type":"uint256"},{"internalType":"uint256","name":"feeBIn","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"contract IMaverickV2Pool","name":"pool","type":"address"}],"name":"tokenScales","outputs":[{"internalType":"uint256","name":"tokenAScale","type":"uint256"},{"internalType":"uint256","name":"tokenBScale","type":"uint256"}],"stateMutability":"view","type":"function"}]')
    abi_2 = json.loads("[{\"inputs\":[{\"internalType\":\"address\",\"name\":\"_l2Bridge\",\"type\":\"address\"},{\"internalType\":\"address\",\"name\":\"_l1Token\",\"type\":\"address\"},{\"internalType\":\"string\",\"name\":\"_name\",\"type\":\"string\"},{\"internalType\":\"string\",\"name\":\"_symbol\",\"type\":\"string\"}],\"stateMutability\":\"nonpayable\",\"type\":\"constructor\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"internalType\":\"address\",\"name\":\"owner\",\"type\":\"address\"},{\"indexed\":true,\"internalType\":\"address\",\"name\":\"spender\",\"type\":\"address\"},{\"indexed\":false,\"internalType\":\"uint256\",\"name\":\"value\",\"type\":\"uint256\"}],\"name\":\"Approval\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"internalType\":\"address\",\"name\":\"_account\",\"type\":\"address\"},{\"indexed\":false,\"internalType\":\"uint256\",\"name\":\"_amount\",\"type\":\"uint256\"}],\"name\":\"Burn\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"internalType\":\"address\",\"name\":\"_account\",\"type\":\"address\"},{\"indexed\":false,\"internalType\":\"uint256\",\"name\":\"_amount\",\"type\":\"uint256\"}],\"name\":\"Mint\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"internalType\":\"address\",\"name\":\"from\",\"type\":\"address\"},{\"indexed\":true,\"internalType\":\"address\",\"name\":\"to\",\"type\":\"address\"},{\"indexed\":false,\"internalType\":\"uint256\",\"name\":\"value\",\"type\":\"uint256\"}],\"name\":\"Transfer\",\"type\":\"event\"},{\"inputs\":[{\"internalType\":\"address\",\"name\":\"owner\",\"type\":\"address\"},{\"internalType\":\"address\",\"name\":\"spender\",\"type\":\"address\"}],\"name\":\"allowance\",\"outputs\":[{\"internalType\":\"uint256\",\"name\":\"\",\"type\":\"uint256\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"address\",\"name\":\"spender\",\"type\":\"address\"},{\"internalType\":\"uint256\",\"name\":\"amount\",\"type\":\"uint256\"}],\"name\":\"approve\",\"outputs\":[{\"internalType\":\"bool\",\"name\":\"\",\"type\":\"bool\"}],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"address\",\"name\":\"account\",\"type\":\"address\"}],\"name\":\"balanceOf\",\"outputs\":[{\"internalType\":\"uint256\",\"name\":\"\",\"type\":\"uint256\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"address\",\"name\":\"_from\",\"type\":\"address\"},{\"internalType\":\"uint256\",\"name\":\"_amount\",\"type\":\"uint256\"}],\"name\":\"burn\",\"outputs\":[],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"decimals\",\"outputs\":[{\"internalType\":\"uint8\",\"name\":\"\",\"type\":\"uint8\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"address\",\"name\":\"spender\",\"type\":\"address\"},{\"internalType\":\"uint256\",\"name\":\"subtractedValue\",\"type\":\"uint256\"}],\"name\":\"decreaseAllowance\",\"outputs\":[{\"internalType\":\"bool\",\"name\":\"\",\"type\":\"bool\"}],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"address\",\"name\":\"spender\",\"type\":\"address\"},{\"internalType\":\"uint256\",\"name\":\"addedValue\",\"type\":\"uint256\"}],\"name\":\"increaseAllowance\",\"outputs\":[{\"internalType\":\"bool\",\"name\":\"\",\"type\":\"bool\"}],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"l1Token\",\"outputs\":[{\"internalType\":\"address\",\"name\":\"\",\"type\":\"address\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"l2Bridge\",\"outputs\":[{\"internalType\":\"address\",\"name\":\"\",\"type\":\"address\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"address\",\"name\":\"_to\",\"type\":\"address\"},{\"internalType\":\"uint256\",\"name\":\"_amount\",\"type\":\"uint256\"}],\"name\":\"mint\",\"outputs\":[],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"name\",\"outputs\":[{\"internalType\":\"string\",\"name\":\"\",\"type\":\"string\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"bytes4\",\"name\":\"_interfaceId\",\"type\":\"bytes4\"}],\"name\":\"supportsInterface\",\"outputs\":[{\"internalType\":\"bool\",\"name\":\"\",\"type\":\"bool\"}],\"stateMutability\":\"pure\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"symbol\",\"outputs\":[{\"internalType\":\"string\",\"name\":\"\",\"type\":\"string\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"totalSupply\",\"outputs\":[{\"internalType\":\"uint256\",\"name\":\"\",\"type\":\"uint256\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"address\",\"name\":\"recipient\",\"type\":\"address\"},{\"internalType\":\"uint256\",\"name\":\"amount\",\"type\":\"uint256\"}],\"name\":\"transfer\",\"outputs\":[{\"internalType\":\"bool\",\"name\":\"\",\"type\":\"bool\"}],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"address\",\"name\":\"sender\",\"type\":\"address\"},{\"internalType\":\"address\",\"name\":\"recipient\",\"type\":\"address\"},{\"internalType\":\"uint256\",\"name\":\"amount\",\"type\":\"uint256\"}],\"name\":\"transferFrom\",\"outputs\":[{\"internalType\":\"bool\",\"name\":\"\",\"type\":\"bool\"}],\"stateMutability\":\"nonpayable\",\"type\":\"function\"}]")
    
    contract_address = "0x942646b0A8B42Af1e1044439013436a9a3e080b5"
    
    address = Web3.to_checksum_address(contract_address)
    contract = web3.eth.contract( address = address, abi = abi_1 )
    
    # pool_address ABI
    pool_address = Web3.to_checksum_address(pool_address) 
    pool_abi = json.loads('[{"inputs":[],"stateMutability":"nonpayable","type":"constructor"},{"inputs":[],"name":"MathOverflowedMulDiv","type":"error"},{"inputs":[{"internalType":"uint256","name":"binIdsLength","type":"uint256"},{"internalType":"uint256","name":"amountsLength","type":"uint256"}],"name":"PoolBinIdsAmountsLengthMismatch","type":"error"},{"inputs":[{"internalType":"int32","name":"startingTick","type":"int32"}],"name":"PoolCurrentTickBeyondSwapLimit","type":"error"},{"inputs":[],"name":"PoolFunctionNotImplemented","type":"error"},{"inputs":[{"internalType":"uint256","name":"deltaLpAmount","type":"uint256"},{"internalType":"uint256","name":"accountBalance","type":"uint256"}],"name":"PoolInsufficientBalance","type":"error"},{"inputs":[],"name":"PoolInvalidFee","type":"error"},{"inputs":[{"internalType":"uint256","name":"kinds","type":"uint256"},{"internalType":"uint256","name":"kind","type":"uint256"}],"name":"PoolKindNotSupported","type":"error"},{"inputs":[],"name":"PoolLocked","type":"error"},{"inputs":[],"name":"PoolMigrateBinFirst","type":"error"},{"inputs":[],"name":"PoolMinimumLiquidityNotMet","type":"error"},{"inputs":[{"internalType":"uint256","name":"amount","type":"uint256"}],"name":"PoolReservesExceedMaximum","type":"error"},{"inputs":[{"internalType":"address","name":"sender_","type":"address"},{"internalType":"address","name":"accessor","type":"address"}],"name":"PoolSenderNotAccessor","type":"error"},{"inputs":[{"internalType":"address","name":"sender_","type":"address"},{"internalType":"address","name":"accessor","type":"address"}],"name":"PoolSenderNotFactory","type":"error"},{"inputs":[{"internalType":"uint256","name":"tick","type":"uint256"}],"name":"PoolTickMaxExceeded","type":"error"},{"inputs":[{"internalType":"uint256","name":"ticksLength","type":"uint256"},{"internalType":"uint256","name":"amountsLength","type":"uint256"}],"name":"PoolTicksAmountsLengthMismatch","type":"error"},{"inputs":[{"internalType":"uint256","name":"index","type":"uint256"},{"internalType":"int256","name":"previousTick","type":"int256"},{"internalType":"int256","name":"tick","type":"int256"}],"name":"PoolTicksNotSorted","type":"error"},{"inputs":[{"internalType":"uint256","name":"internalReserve","type":"uint256"},{"internalType":"uint256","name":"tokenBalance","type":"uint256"},{"internalType":"contract IERC20","name":"token","type":"address"}],"name":"PoolTokenNotSolvent","type":"error"},{"inputs":[{"internalType":"uint256","name":"amount","type":"uint256"},{"internalType":"uint256","name":"bits","type":"uint256"}],"name":"PoolValueExceedsBits","type":"error"},{"inputs":[],"name":"PoolZeroLiquidityAdded","type":"error"},{"inputs":[{"internalType":"uint8","name":"bits","type":"uint8"},{"internalType":"uint256","name":"value","type":"uint256"}],"name":"SafeCastOverflowedUintDowncast","type":"error"},{"inputs":[{"internalType":"int256","name":"tick","type":"int256"}],"name":"TickMaxExceeded","type":"error"},{"inputs":[{"internalType":"contract IERC20","name":"token","type":"address"},{"internalType":"address","name":"to","type":"address"},{"internalType":"uint256","name":"amount","type":"uint256"}],"name":"TransferFailed","type":"error"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"address","name":"sender","type":"address"},{"indexed":false,"internalType":"address","name":"recipient","type":"address"},{"indexed":false,"internalType":"uint256","name":"subaccount","type":"uint256"},{"components":[{"internalType":"uint8","name":"kind","type":"uint8"},{"internalType":"int32[]","name":"ticks","type":"int32[]"},{"internalType":"uint128[]","name":"amounts","type":"uint128[]"}],"indexed":false,"internalType":"struct IMaverickV2Pool.AddLiquidityParams","name":"params","type":"tuple"},{"indexed":false,"internalType":"uint256","name":"tokenAAmount","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"tokenBAmount","type":"uint256"},{"indexed":false,"internalType":"uint32[]","name":"binIds","type":"uint32[]"}],"name":"PoolAddLiquidity","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"address","name":"sender","type":"address"},{"indexed":false,"internalType":"uint32","name":"binId","type":"uint32"},{"indexed":false,"internalType":"uint32","name":"maxRecursion","type":"uint32"}],"name":"PoolMigrateBinsUpStack","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"uint256","name":"feeCollected","type":"uint256"},{"indexed":false,"internalType":"bool","name":"isTokenA","type":"bool"}],"name":"PoolProtocolFeeCollected","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"address","name":"sender","type":"address"},{"indexed":false,"internalType":"address","name":"recipient","type":"address"},{"indexed":false,"internalType":"uint256","name":"subaccount","type":"uint256"},{"components":[{"internalType":"uint32[]","name":"binIds","type":"uint32[]"},{"internalType":"uint128[]","name":"amounts","type":"uint128[]"}],"indexed":false,"internalType":"struct IMaverickV2Pool.RemoveLiquidityParams","name":"params","type":"tuple"},{"indexed":false,"internalType":"uint256","name":"tokenAOut","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"tokenBOut","type":"uint256"}],"name":"PoolRemoveLiquidity","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"uint256","name":"lendingFeeRateD18","type":"uint256"}],"name":"PoolSetLendingFeeRate","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"uint256","name":"protocolFeeRatioD3","type":"uint256"}],"name":"PoolSetProtocolFeeRatio","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"uint256","name":"newFeeAIn","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"newFeeBIn","type":"uint256"}],"name":"PoolSetVariableFee","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"address","name":"sender","type":"address"},{"indexed":false,"internalType":"address","name":"recipient","type":"address"},{"components":[{"internalType":"uint256","name":"amount","type":"uint256"},{"internalType":"bool","name":"tokenAIn","type":"bool"},{"internalType":"bool","name":"exactOutput","type":"bool"},{"internalType":"int32","name":"tickLimit","type":"int32"}],"indexed":false,"internalType":"struct IMaverickV2Pool.SwapParams","name":"params","type":"tuple"},{"indexed":false,"internalType":"uint256","name":"amountIn","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"amountOut","type":"uint256"}],"name":"PoolSwap","type":"event"},{"inputs":[],"name":"accessor","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"recipient","type":"address"},{"internalType":"uint256","name":"subaccount","type":"uint256"},{"components":[{"internalType":"uint8","name":"kind","type":"uint8"},{"internalType":"int32[]","name":"ticks","type":"int32[]"},{"internalType":"uint128[]","name":"amounts","type":"uint128[]"}],"internalType":"struct IMaverickV2Pool.AddLiquidityParams","name":"params","type":"tuple"},{"internalType":"bytes","name":"data","type":"bytes"}],"name":"addLiquidity","outputs":[{"internalType":"uint256","name":"tokenAAmount","type":"uint256"},{"internalType":"uint256","name":"tokenBAmount","type":"uint256"},{"internalType":"uint32[]","name":"binIds","type":"uint32[]"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"enum IMaverickV2PoolAdmin.AdminAction","name":"action","type":"uint8"},{"internalType":"uint256","name":"value","type":"uint256"}],"name":"adminAction","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"user","type":"address"},{"internalType":"uint256","name":"subaccount","type":"uint256"},{"internalType":"uint32","name":"binId","type":"uint32"}],"name":"balanceOf","outputs":[{"internalType":"uint128","name":"lpBalance","type":"uint128"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"int32","name":"tick","type":"int32"},{"internalType":"uint256","name":"kind","type":"uint256"}],"name":"binIdByTickKind","outputs":[{"internalType":"uint32","name":"binId","type":"uint32"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"factory","outputs":[{"internalType":"contract IMaverickV2Factory","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"bool","name":"tokenAIn","type":"bool"}],"name":"fee","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"recipient","type":"address"},{"internalType":"uint256","name":"amountA","type":"uint256"},{"internalType":"uint256","name":"amountB","type":"uint256"},{"internalType":"bytes","name":"data","type":"bytes"}],"name":"flashLoan","outputs":[{"internalType":"uint128","name":"lendingFeeA","type":"uint128"},{"internalType":"uint128","name":"lendingFeeB","type":"uint128"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint32","name":"binId","type":"uint32"}],"name":"getBin","outputs":[{"components":[{"internalType":"uint128","name":"mergeBinBalance","type":"uint128"},{"internalType":"uint128","name":"tickBalance","type":"uint128"},{"internalType":"uint128","name":"totalSupply","type":"uint128"},{"internalType":"uint8","name":"kind","type":"uint8"},{"internalType":"int32","name":"tick","type":"int32"},{"internalType":"uint32","name":"mergeId","type":"uint32"}],"internalType":"struct IMaverickV2Pool.BinState","name":"bin","type":"tuple"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"getCurrentTwa","outputs":[{"internalType":"int256","name":"","type":"int256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"getState","outputs":[{"components":[{"internalType":"uint128","name":"reserveA","type":"uint128"},{"internalType":"uint128","name":"reserveB","type":"uint128"},{"internalType":"int64","name":"lastTwaD8","type":"int64"},{"internalType":"int64","name":"lastLogPriceD8","type":"int64"},{"internalType":"uint40","name":"lastTimestamp","type":"uint40"},{"internalType":"int32","name":"activeTick","type":"int32"},{"internalType":"bool","name":"isLocked","type":"bool"},{"internalType":"uint32","name":"binCounter","type":"uint32"},{"internalType":"uint8","name":"protocolFeeRatioD3","type":"uint8"}],"internalType":"struct IMaverickV2Pool.State","name":"","type":"tuple"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"int32","name":"tick","type":"int32"}],"name":"getTick","outputs":[{"components":[{"internalType":"uint128","name":"reserveA","type":"uint128"},{"internalType":"uint128","name":"reserveB","type":"uint128"},{"internalType":"uint128","name":"totalSupply","type":"uint128"},{"internalType":"uint32[4]","name":"binIdsByTick","type":"uint32[4]"}],"internalType":"struct IMaverickV2Pool.TickState","name":"_tick","type":"tuple"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"kinds","outputs":[{"internalType":"uint8","name":"_kinds","type":"uint8"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"lendingFeeRateD18","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"lookback","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint32","name":"binId","type":"uint32"},{"internalType":"uint32","name":"maxRecursion","type":"uint32"}],"name":"migrateBinUpStack","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"permissionedLiquidity","outputs":[{"internalType":"bool","name":"_permissionedLiquidity","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"permissionedPool","outputs":[{"internalType":"bool","name":"_permissionedPool","type":"bool"}],"stateMutability":"pure","type":"function"},{"inputs":[],"name":"permissionedSwap","outputs":[{"internalType":"bool","name":"_permissionedSwap","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"protocolFeeA","outputs":[{"internalType":"uint128","name":"","type":"uint128"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"protocolFeeB","outputs":[{"internalType":"uint128","name":"","type":"uint128"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"recipient","type":"address"},{"internalType":"uint256","name":"subaccount","type":"uint256"},{"components":[{"internalType":"uint32[]","name":"binIds","type":"uint32[]"},{"internalType":"uint128[]","name":"amounts","type":"uint128[]"}],"internalType":"struct IMaverickV2Pool.RemoveLiquidityParams","name":"params","type":"tuple"}],"name":"removeLiquidity","outputs":[{"internalType":"uint256","name":"tokenAOut","type":"uint256"},{"internalType":"uint256","name":"tokenBOut","type":"uint256"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"","type":"uint256"},{"internalType":"uint256","name":"","type":"uint256"}],"name":"setFee","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"recipient","type":"address"},{"components":[{"internalType":"uint256","name":"amount","type":"uint256"},{"internalType":"bool","name":"tokenAIn","type":"bool"},{"internalType":"bool","name":"exactOutput","type":"bool"},{"internalType":"int32","name":"tickLimit","type":"int32"}],"internalType":"struct IMaverickV2Pool.SwapParams","name":"params","type":"tuple"},{"internalType":"bytes","name":"data","type":"bytes"}],"name":"swap","outputs":[{"internalType":"uint256","name":"amountIn","type":"uint256"},{"internalType":"uint256","name":"amountOut","type":"uint256"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"tickSpacing","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"tokenA","outputs":[{"internalType":"contract IERC20","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"tokenAScale","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"tokenB","outputs":[{"internalType":"contract IERC20","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"tokenBScale","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"}]')
    pool_contract =  web3.eth.contract( address = pool_address, abi = pool_abi )
    
    scale0 = pool_contract.functions.tokenAScale().call()
    scale1 =pool_contract.functions.tokenBScale().call()
    
    decimals_0 = dict_token_info['token_0']['decimals']
    symbol_0 = dict_token_info['token_0']['symbol']
    decimals_1 = dict_token_info['token_1']['decimals']
    symbol_1 = dict_token_info['token_1']['symbol']
    
    price = contract.functions.getPoolPrice(pool_address).call()
    
    
    
    state_price = 1/(price*1/sqrt(10**decimals_0*scale0*10**decimals_1*scale1) ) 
    
    
    
    
    dict_state_price = {}
    dict_state_price[f'{symbol_0}/{symbol_1}'] = state_price
    dict_state_price[f'{symbol_1}/{symbol_0}'] = 1/state_price
    
    return dict_state_price



# wstETH/WETH
pool_address = "0x68875ad4dC276527790b3a80D397e04abF44344c"

# GHO/USDC
pool_address = "0x14cf6d2fe3e1b326114b07d22a6f6bb59e346c67"

# USDC/USDT
pool_address = "0x31373595f40ea48a7aab6cbcb0d377c6066e2dca"

# USDC/USDS
pool_address = "0xdf9c440111a17eafbecf5db37dd04c948e878878"

# MAV/ETH
pool_address = "0x97a3eb00eb67e6e92d43dfe9c28f5211e05e2342"


dict_token_info = token_info(pool_address)

state_price_maverick_v2(pool_address,dict_token_info)





